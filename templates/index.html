<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Assistant</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <!-- Styles - Fixed for FastAPI -->
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="app">

    <!-- Auth Modal -->
    <div id="authModal" class="auth-modal" hidden>
      <div class="auth-container">
        <div class="auth-form" id="loginForm">
          <h2>Welcome Back</h2>
          <input type="text" id="loginUsername" placeholder="Username" class="auth-input" />
          <input type="password" id="loginPassword" placeholder="Password" class="auth-input" />
          <button id="loginBtn" class="auth-btn">Login</button>
          <p class="auth-switch">Don't have an account? <a href="#" id="switchToSignup">Sign up</a></p>
        </div>

        <div class="auth-form hidden" id="signupForm">
          <h2>Create Account</h2>
          <input type="text" id="signupUsername" placeholder="Username" class="auth-input" />
          <input type="email" id="signupEmail" placeholder="Email" class="auth-input" />
          <input type="password" id="signupPassword" placeholder="Password" class="auth-input" />
          <button id="signupBtn" class="auth-btn">Sign Up</button>
          <p class="auth-switch">Already have an account? <a href="#" id="switchToLogin">Login</a></p>
        </div>
      </div>
    </div>

    <!-- User menu (top right) -->
    <div class="user-menu-container">
      <button id="userMenuBtn" class="user-menu-btn" title="User menu">ğŸ‘¤</button>
      <div id="userMenu" class="user-menu" hidden>
        <div id="userInfo" class="user-info">Guest (Limited)</div>
        <button id="settingsBtn" class="menu-item" style="display:none;">âš™ï¸ Preferences</button>
        <button id="signInBtn" class="menu-item" style="display:none;">Sign In</button>
        <button id="logoutBtn" class="menu-item">Logout</button>
      </div>
    </div>

    <!-- Sidebar toggle button -->
    <button id="sidebarToggle" class="sidebar-toggle" aria-controls="appSidebar" aria-expanded="true" aria-label="Toggle navigation">â˜°</button>

    <!-- OVERLAY (used on small screens when sidebar slides in) -->
    <div id="sidebarOverlay" class="overlay" hidden></div>

    <!-- ========== SIDEBAR ========== -->
    <aside id="appSidebar" class="sidebar" role="navigation" aria-hidden="false">
      <nav class="nav-top">
        <div class="nav-item" data-action="new-chat" role="button" tabindex="0">
          âœï¸ <span>New chat</span>
        </div>
        <div class="nav-item" data-action="search" role="button" tabindex="0">
          ğŸ” <span>Search chats</span>
        </div>
        <div class="nav-item" data-action="images" role="button" tabindex="0">
          ğŸ–¼ï¸ <span>Images <small class="badge">NEW</small></span>
        </div>
        <div class="nav-item" data-action="apps" role="button" tabindex="0">
          ğŸŒ <span>Apps</span>
        </div>
        <div class="nav-item" data-action="projects" role="button" tabindex="0">
          ğŸ“ <span>Projects</span>
        </div>
      </nav>

      <nav class="nav-bottom">
        <div class="mode-section">
          <button id="modeBtn" class="mode-btn online" title="Click to toggle between online and offline" aria-pressed="false">
            ğŸ”µ Online
          </button>
        </div>

        <div class="chat-history-section">
          <div class="section-header">
            <span>ğŸ’¬ Chat History</span>
            <button class="clear-btn" id="clearHistoryBtn" title="Clear all chats" aria-label="Clear chat history">âœ•</button>
          </div>
          <div class="chat-history" id="chatList">
            <div class="empty-history">No chats yet</div>
          </div>
        </div>
      </nav>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="chat-area" id="mainContent" tabindex="-1">
      <!-- Center Prompt -->
      <section class="empty-state" id="emptyState">
        <div class="empty-card">
          <h1>What can I help with?</h1>
          <p class="subtitle">Try: "Summarize my notes", "Write an email", or "Generate a plan"</p>
        </div>
      </section>

      <!-- Chat messages (hidden initially) -->
      <section class="chat-box" id="chatBox" aria-live="polite"></section>

      <!-- Loading Indicator -->
      <div class="loading-indicator" id="loadingIndicator" aria-hidden="true">
        <div class="spinner"></div>
        <p>Thinking...</p>
      </div>

      <!-- Input -->
      <footer class="chat-input-container" aria-label="Chat input">
        <div class="input-container">
          <textarea
        id="chatInput"
        class="chat-input"
        placeholder="+ Ask anything"
        autocomplete="off"
        rows="1"
        style="resize: none; overflow: hidden;"
     ></textarea>
  <!-- Buttons INSIDE input -->
  <div class="input-icons">
    <button class="icon-btn" type="button" title="Voice">ğŸ¤</button>
    <button class="icon-btn" type="button" title="Attach">ğŸ“</button>
    <button id="sendBtn" class="icon-btn primary" type="button" title="Send">â¤</button>
  </div>
</div>

          <!-- Quick Action Buttons -->
          <div class="quick-actions" aria-hidden="false">
            <button class="quick-btn" data-action="code" title="Generate code">ğŸ’»</button>
            <button class="quick-btn" data-action="explain" title="Explain topic">ğŸ“š</button>
            <button class="quick-btn" data-action="creative" title="Creative writing">âœ¨</button>
            <button class="quick-btn" data-action="analyze" title="Analyze">ğŸ”</button>
          </div>
        </div>
      </footer>

    </main>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="settings-modal" hidden>
    <div class="settings-container">
      <div class="settings-header">
        <h2>âš™ï¸ Preferences</h2>
        <button class="close-btn" id="closeSettingsBtn">âœ•</button>
      </div>

      <div class="settings-content">
        <!-- Response Format Section -->
        <div class="settings-section">
          <h3>Response Format</h3>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="useListsToggle" checked> Use Lists
            </label>
            <small>Break responses into clear list items</small>
          </div>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="useNumberedToggle" checked> Use Numbered Lists
            </label>
            <small>Number sequential items (1, 2, 3...)</small>
          </div>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="useBulletsToggle" checked> Use Bullet Points
            </label>
            <small>Use â€¢ for non-sequential items</small>
          </div>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="useEmojisToggle" checked> Use Emojis
            </label>
            <small>Add visual indicators with emojis</small>
          </div>
        </div>

        <!-- Tone Section -->
        <div class="settings-section">
          <h3>Communication Style</h3>
          <div class="setting-item">
            <label for="toneSelect">Preferred Tone:</label>
            <select id="toneSelect">
              <option value="professional">Professional</option>
              <option value="casual">Casual</option>
              <option value="technical">Technical</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="languageSelect">Language:</label>
            <select id="languageSelect">
              <option value="en">English</option>
              <option value="es">EspaÃ±ol</option>
              <option value="fr">FranÃ§ais</option>
              <option value="de">Deutsch</option>
              <option value="ja">æ—¥æœ¬èª</option>
            </select>
          </div>
        </div>

        <!-- Learning Section -->
        <div class="settings-section">
          <h3>Learning</h3>
          <div class="setting-item">
            <label>
              <input type="checkbox" id="learningModeToggle" checked> Learning Mode
            </label>
            <small>System learns your preferences and specializations</small>
          </div>
          <div class="setting-item">
            <label for="specializationInput">Your Specializations:</label>
            <input type="text" id="specializationInput" placeholder="e.g., Python, Web Development, Data Science (comma separated)" class="settings-input">
            <small>Help the system tailor responses to your expertise</small>
          </div>
        </div>
      </div>

      <div class="settings-footer">
        <button id="resetSettingsBtn" class="secondary-btn">Reset to Defaults</button>
        <button id="saveSettingsBtn" class="primary-btn">Save Preferences</button>
      </div>
    </div>
  </div>

  <script src="/static/script.js"></script>
  <!-- Authentication handler -->
  <script src="/static/auth.js"></script>
</body>
</html>